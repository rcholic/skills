{
  "skill_shield_version": "0.2.0",
  "scan_timestamp": "2026-02-20T17:11:46.951721+00:00",
  "skill_path": "/home/lyall/.openclaw/workspace/agents-workspace/skill-shield/skill",
  "skill_name": "skill",
  "pattern_count": 65,
  "permissions": {
    "declared": [
      "exec",
      "process"
    ],
    "found_in_code": [
      "browser",
      "canvas",
      "cron",
      "edit",
      "exec",
      "gateway",
      "memory_get",
      "memory_search",
      "message",
      "nodes",
      "process",
      "read",
      "sessions_history",
      "sessions_list",
      "sessions_send",
      "sessions_spawn",
      "subagents",
      "tts",
      "web_fetch",
      "web_search",
      "write"
    ],
    "undeclared": [
      "browser",
      "canvas",
      "cron",
      "edit",
      "gateway",
      "memory_get",
      "memory_search",
      "message",
      "nodes",
      "read",
      "sessions_history",
      "sessions_list",
      "sessions_send",
      "sessions_spawn",
      "subagents",
      "tts",
      "web_fetch",
      "web_search",
      "write"
    ],
    "unused_declared": [],
    "properly_declared": [
      "exec",
      "process"
    ],
    "undeclared_risk_details": [
      {
        "tool": "browser",
        "sensitivity": 4,
        "recommendation": "⚠️ High-sensitivity tool 'browser' used but not declared — requires justification"
      },
      {
        "tool": "canvas",
        "sensitivity": 2,
        "recommendation": "Add 'canvas' to SKILL.md permissions"
      },
      {
        "tool": "cron",
        "sensitivity": 3,
        "recommendation": "Add 'cron' to SKILL.md permissions"
      },
      {
        "tool": "edit",
        "sensitivity": 4,
        "recommendation": "⚠️ High-sensitivity tool 'edit' used but not declared — requires justification"
      },
      {
        "tool": "gateway",
        "sensitivity": 5,
        "recommendation": "⚠️ High-sensitivity tool 'gateway' used but not declared — requires justification"
      },
      {
        "tool": "memory_get",
        "sensitivity": 2,
        "recommendation": "Add 'memory_get' to SKILL.md permissions"
      },
      {
        "tool": "memory_search",
        "sensitivity": 2,
        "recommendation": "Add 'memory_search' to SKILL.md permissions"
      },
      {
        "tool": "message",
        "sensitivity": 3,
        "recommendation": "Add 'message' to SKILL.md permissions"
      },
      {
        "tool": "nodes",
        "sensitivity": 4,
        "recommendation": "⚠️ High-sensitivity tool 'nodes' used but not declared — requires justification"
      },
      {
        "tool": "read",
        "sensitivity": 2,
        "recommendation": "Add 'read' to SKILL.md permissions"
      },
      {
        "tool": "sessions_history",
        "sensitivity": 2,
        "recommendation": "Add 'sessions_history' to SKILL.md permissions"
      },
      {
        "tool": "sessions_list",
        "sensitivity": 2,
        "recommendation": "Add 'sessions_list' to SKILL.md permissions"
      },
      {
        "tool": "sessions_send",
        "sensitivity": 3,
        "recommendation": "Add 'sessions_send' to SKILL.md permissions"
      },
      {
        "tool": "sessions_spawn",
        "sensitivity": 3,
        "recommendation": "Add 'sessions_spawn' to SKILL.md permissions"
      },
      {
        "tool": "subagents",
        "sensitivity": 3,
        "recommendation": "Add 'subagents' to SKILL.md permissions"
      },
      {
        "tool": "tts",
        "sensitivity": 1,
        "recommendation": "Add 'tts' to SKILL.md permissions"
      },
      {
        "tool": "web_fetch",
        "sensitivity": 3,
        "recommendation": "Add 'web_fetch' to SKILL.md permissions"
      },
      {
        "tool": "web_search",
        "sensitivity": 2,
        "recommendation": "Add 'web_search' to SKILL.md permissions"
      },
      {
        "tool": "write",
        "sensitivity": 4,
        "recommendation": "⚠️ High-sensitivity tool 'write' used but not declared — requires justification"
      }
    ],
    "undeclared_risk_score": 54,
    "declaration_coverage": "2/21"
  },
  "findings": [
    {
      "pattern_id": "base64_decode",
      "pattern_name": "base64 decode call",
      "severity": 3,
      "original_severity": 3,
      "category": "obfuscation",
      "cwe": "CWE-116",
      "file": "scan.py",
      "line": 253,
      "match": "base64.b64decode",
      "context": "decoded = base64.b64decode(candidate).decode(\"utf-8\", errors=\"replace\")",
      "in_comment": false,
      "in_docstring": false,
      "in_code_block": false
    }
  ],
  "summary": {
    "total_findings": 1,
    "obfuscated_findings": 0,
    "context_reduced": 0,
    "by_category": {
      "obfuscation": 1
    },
    "by_severity": {
      "3": 1
    },
    "max_severity": 3,
    "cwe_references": [
      "CWE-116"
    ]
  },
  "rating": "D",
  "rating_reason": "High risk — critical patterns detected, manual review required"
}